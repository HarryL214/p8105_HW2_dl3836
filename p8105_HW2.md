P8105_hw2
================
Dianchen Li
2025-09-30

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(janitor)
```

    ## 
    ## Attaching package: 'janitor'
    ## 
    ## The following objects are masked from 'package:stats':
    ## 
    ##     chisq.test, fisher.test

``` r
library(here)
```

    ## here() starts at /Users/harry/Desktop/p8105_HW2_dl3836

``` r
library(readxl)
library(stringr)
```

\#Problem 1 \## Tidy up pols_month.csv

``` r
pols = 
  read_csv(here("pols-month.csv")) %>% 
  clean_names() %>% 
  separate(mon, into = c("year", "month", "day"), sep = "-", convert = TRUE) %>% 
  mutate(
    month = tolower(month.name[month]),
    president = if_else(prez_gop == 1, "gop", "dem")
  ) %>% 
  select(year, month, president,
         gov_gop, sen_gop, rep_gop,
         gov_dem, sen_dem, rep_dem) %>% 
  arrange(year, month)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

\##Tidy up snp.csv

``` r
snp = 
  read_csv(here("snp.csv")) %>% 
  clean_names() %>% 
  separate(date, into = c("month", "day", "year"), sep = "/", convert = TRUE) %>% 
  mutate(
    year = year + 2000,
    year = if_else(year > 2015, year - 100, year),
    month = tolower(month.name[month])
  ) %>% 
  select(year, month, close) %>% 
  arrange(year, month)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

## Tidy up unemployment.csv

``` r
unemp = 
  read_csv(here("unemployment.csv")) %>% 
  clean_names() %>% 
  pivot_longer(
    jan:dec, 
    names_to = "month_abbr", values_to = "unemployment"
  ) %>% 
  mutate(
    month = recode(month_abbr,
      "jan" = "january", "feb" = "february", "mar" = "march",
      "apr" = "april",   "may" = "may",       "jun" = "june",
      "jul" = "july",    "aug" = "august",    "sep" = "september",
      "oct" = "october", "nov" = "november",  "dec" = "december"
    )
  ) %>% 
  select(year, month, unemployment) %>% 
  arrange(year, month)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

\##Combine each dataset

``` r
merged_df <- 
  pols %>% 
  left_join(snp,   by = c("year", "month")) %>% 
  left_join(unemp, by = c("year", "month")) %>% 
  arrange(year, month)
```

\#Problem 2

``` r
tw_path = here( "202409 Trash Wheel Collection Data.xlsx")
```

\##Specify which column we want to keep

``` r
wanted_cols = c(
  "dumpster", "month", "year", "date",
  "weight_tons", "volume_cubic_yards",
  "plastic_bottles", "polystyrene",
  "cigarette_butts", "glass_bottles",
  "grocery_bags", "chip_bags",
  "sports_balls", "homes_powered"
)

read_clean_trash = function(sheet_name, wheel_label, skip_rows = 1) {

  raw = read_excel(
    path  = tw_path,
    sheet = sheet_name,
    skip  = skip_rows
  ) %>%
    clean_names()

  keep = intersect(wanted_cols, names(raw))

  df = raw %>%
    select(all_of(keep)) %>%
    # keep only rows with a dumpster number (drop totals/notes)
    filter(!is.na(dumpster)) %>%
    mutate(
      month = str_to_title(as.character(month)),
      date  = as.Date(date),
      year  = as.integer(year),
      wheel = wheel_label
    )
  
if (!"sports_balls" %in% names(df)) {
    df = df %>% mutate(sports_balls = NA_integer_)
  } else {
    df = df %>% mutate(sports_balls = as.integer(round(sports_balls)))
  }

  return(df)
}
```

\##Then we read the three relevent variable and clean it

``` r
mr_df   = read_clean_trash("Mr. Trash Wheel", "Mr. Trash Wheel")
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

``` r
prof_df = read_clean_trash("Professor Trash Wheel",  "Professor Trash Wheel")
gwyn_df = read_clean_trash("Gwynnda Trash Wheel",    "Gwynnda Trash Wheel")

trash_all = bind_rows(mr_df, prof_df, gwyn_df) %>%
  arrange(year, month, dumpster)
```

\##Data for Inline R

``` r
n_obs_trash = nrow(trash_all)
prof_total_weight = trash_all %>%
  filter(wheel == "Professor Trash Wheel") %>%
  summarise(total_weight_tons = sum(weight_tons, na.rm = TRUE)) %>%
  pull(total_weight_tons)

gwyn_jun2022_cigs = trash_all %>%
  filter(wheel == "Gwynnda Trash Wheel", year == 2022, month == "June") %>%
  summarise(total_cigs = sum(cigarette_butts, na.rm = TRUE)) %>%
  pull(total_cigs)

key_vars = intersect(wanted_cols, names(trash_all))
```

After cleaning and combinin, thedataset contains **1033 observations**,
and each obswervation correlates to a dumpsterand contains variables
like **dumpster, month, year, date, weight_tons, volume_cubic_yards,
plastic_bottles, polystyrene, cigarette_butts, glass_bottles,
sports_balls, homes_powered**, that create a link to the collection
time, weight of trash, volume of trash, and so on. In the available
data, **Professor Trash Wheel** collected a total of **246.7 tons** of
trash, and **Gwynnda Trash Wheel** collected **1.812^{4} cigarette
butts** in **June 2022**.
